'use strict';

angular.module( "bgImage", [])
	.directive('bgImage', function ($window, $timeout) {
		return function (scope, element, attrs) {
			var resizeBG = function () {
				var bgwidth = element.width();
				var bgheight = element.height();

				var winwidth = $window.innerWidth;
				var winheight = $window.innerHeight;

				var widthratio = winwidth / bgwidth;
				var heightratio = winheight / bgheight;

				var widthdiff = heightratio * bgwidth;
				var heightdiff = widthratio * bgheight;

				if (heightdiff > winheight) {
					element.css({
						width: winwidth + 'px',
						height: heightdiff + 'px'
					});
				} else {
					element.css({
						width: widthdiff + 'px',
						height: winheight + 'px'
					});
				}
			};

			var windowElement = angular.element($window);
			windowElement.resize(resizeBG);

			element.bind('load', function () {
				resizeBG();
			});
		}
	});


